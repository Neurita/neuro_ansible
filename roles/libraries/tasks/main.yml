---

# - name: libraries | Make local downloads dir in {{ local_downloads_dir }}
#   local_action: path dest="{{ local_downloads_dir }}" state=directory

- name: libraries | apt_repository
  command: >
      add-apt-repository {{ item }}
  with_items:
    - restricted
    - universe
  become: yes
  become_method: sudo

- name: libraries | Update cache
  apt:
    update_cache: yes
    cache_valid_time: 3600
  become: yes
  become_method: sudo

- name: libraries | Install packages
  apt:
    name: "{{ item }}"
    state: present
    allow_unauthenticated: yes
  with_items:
    - apt-utils
    - gcc-6
    - g++-6
    - locales
    - libjpeg62
    - libxml2-dev
    - libxslt1-dev
    - xdot
    - python3-dev
  become: yes
  become_method: sudo

- name: 'libraries | Add {{ local_bin_dir }} to PATH in {{ target_bashrc_file }}'
  lineinfile:
    dest: "{{ target_bashrc_file }}"
    regexp: '^addpath {{ local_bin_dir }}$'
    line: 'addpath {{ local_bin_dir }}'
    follow: yes
    create: yes
  tags: rc

- name: libraries | Add {{ user_local_dir }} to CMAKE_PREFIX_PATH
  lineinfile: >
    name=/etc/environment
    state=present
    regexp="^CMAKE_PREFIX_PATH=.*"
    line='CMAKE_PREFIX_PATH="{{ user_local_dir }}"'
  become: yes
  become_method: sudo
  tags: [ld_config, rc]

- import_tasks: neurodebian.yml
  tags: neurodebian

- import_tasks: libs/fsl.yml
  tags: fsl

- import_tasks: libs/afni.yml
  tags: afni

- import_tasks: libs/camino.yml
  tags: camino

- import_tasks: libs/spm_mcr.yml
  tags: spm_mcr

- import_tasks: libs/cmake.yml
  tags: cmake

- import_tasks: libs/dcm2niix.yml
  tags: dcm2niix

- block:
  - import_tasks: libs/vtk.yml
    tags: vtk

  - import_tasks: libs/ants.yml
    tags: ants

  - import_tasks: libs/petpvc.yml
    tags: petpvc

  - import_tasks: libs/simpleitk.yml
    tags: simpleitk

  - name: '{{ lib_name }} | Remove {{ ants_build_dir }} directory'
    file:
      path: "{{ ants_build_dir }}"
      state: absent
    become: yes
    become_method: sudo
    when: cleanup_sources
    tags: cleanup

  tags: itk

# - import_tasks: libs/boost.yml
#   tags: boost
#
# - import_tasks: libs/eigen3.yml
#   tags: eigen3
#
# - import_tasks: libs/json.yml
#   tags: json
#
# - import_tasks: libs/qt5_download.yml
#   tags: qt5

# - import_tasks: libs/googletest.yml
#   tags: googletest
